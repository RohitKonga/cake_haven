# üîê Fix MongoDB Authentication Error

## Error Message
```
bad auth : authentication failed
MongoServerError: bad auth : authentication failed
```

## What This Means
The **username or password** in your `MONGO_URI` is incorrect. MongoDB Atlas is rejecting the connection because the credentials don't match.

## ‚úÖ Solution: Reset MongoDB Password

### Step 1: Reset Password in MongoDB Atlas

1. Go to [MongoDB Atlas Dashboard](https://cloud.mongodb.com/)
2. Click **Security** ‚Üí **Database Access**
3. Find your user: `kathiematthews02_db_user`
4. Click the **Edit** button (pencil icon) next to the user
5. Click **Edit Password**
6. Enter a **new password** (or use "Autogenerate Secure Password")
7. **Copy the password** - you'll need it!
8. Click **Update User**

### Step 2: Update MONGO_URI in Render

1. Go to [Render Dashboard](https://dashboard.render.com/)
2. Click on your **Web Service** (cake-haven)
3. Go to **Environment** tab
4. Find `MONGO_URI` variable
5. Click **Edit**

6. Update the password in the connection string:
   ```
   mongodb+srv://kathiematthews02_db_user:YOUR_NEW_PASSWORD@cluster0.lll5jhg.mongodb.net/cake_haven?retryWrites=true&w=majority
   ```
   
   **Replace `YOUR_NEW_PASSWORD` with the password you just set in Atlas**

7. Click **Save Changes**
8. Render will automatically redeploy

### Step 3: Verify Connection

After redeploy, check Render logs:
- ‚úÖ Should see: `‚úÖ Connected to MongoDB`
- ‚ùå If you still see auth errors, double-check the password

### Step 4: Test Health Endpoint

Visit: `https://cake-haven.onrender.com/health`

Should return:
```json
{
  "ok": true,
  "service": "cake-haven-api",
  "mongodb": "connected",
  "timestamp": "2024-..."
}
```

## üîç Important Notes

### Password Special Characters
If your password contains special characters, you need to **URL encode** them in the MONGO_URI:

- `@` ‚Üí `%40`
- `#` ‚Üí `%23`
- `$` ‚Üí `%24`
- `%` ‚Üí `%25`
- `&` ‚Üí `%26`
- `+` ‚Üí `%2B`
- `=` ‚Üí `%3D`
- `?` ‚Üí `%3F`

**Example:**
If password is `P@ssw0rd#123`, use `P%40ssw0rd%23123` in MONGO_URI

### Or Use Autogenerated Password
**Easier option:** Use MongoDB Atlas "Autogenerate Secure Password" - it creates a password without special characters that need encoding.

## üìù Quick Checklist

- [ ] Reset password in MongoDB Atlas Database Access
- [ ] Copied the new password
- [ ] Updated MONGO_URI in Render with new password
- [ ] Saved changes in Render (triggers redeploy)
- [ ] Checked Render logs for "‚úÖ Connected to MongoDB"
- [ ] Tested health endpoint

## üöÄ After Fixing

Once authentication works:
1. Your server will connect to MongoDB
2. Cakes will load in your app
3. All database features will work

---

**Still having issues?** Make sure:
- Password is copied correctly (no extra spaces)
- Special characters are URL encoded
- MONGO_URI format is correct: `mongodb+srv://USERNAME:PASSWORD@CLUSTER/DATABASE?retryWrites=true&w=majority`

